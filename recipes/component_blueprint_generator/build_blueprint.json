{
  "steps": [
    {
      "type": "read_file",
      "path": "{{candidate_spec_path}}",
      "artifact": "candidate_spec"
    },
    {
      "type": "read_file",
      "path": "recipes/component_blueprint_generator/includes/SPEC_DOC_GUIDE.md",
      "artifact": "spec_doc_guide"
    },
    {
      "type": "read_file",
      "path": "recipes/codebase_generator/includes/IMPLEMENTATION_PHILOSOPHY.md",
      "artifact": "implementation_philosophy"
    },
    {
      "type": "read_file",
      "path": "recipes/component_blueprint_generator/includes/MODULAR_DESIGN_PHILOSOPHY.md",
      "artifact": "modular_design_philosophy"
    },
    {
      "type": "read_file",
      "path": "recipes/test_generator/includes/TESTING_BEST_PRACTICES.md",
      "artifact": "testing_best_practices",
      "optional": true
    },
    {
      "type": "read_file",
      "path": "recipes/dependency_setup_generator/includes/DEPENDENCY_BEST_PRACTICES.md",
      "artifact": "dependency_best_practices",
      "optional": true
    },
    {
      "type": "read_file",
      "path": "recipes/library_integration_generator/includes/LIBRARY_INTEGRATION_BEST_PRACTICES.md",
      "artifact": "library_integration_best_practices",
      "optional": true
    },
    {
      "type": "read_file",
      "path": "recipes/component_composition_generator/includes/COMPOSITION_BEST_PRACTICES.md",
      "artifact": "composition_best_practices",
      "optional": true
    },
    {
      "type": "generate",
      "prompt": "You are an expert developer analyzing a candidate specification. Extract key information needed for component generation including extended requirements.\n\nCandidate Specification:\n{{candidate_spec}}\n\nExtract these fields only if not already provided:\n- component_id: {{component_id|default:''}}\n- component_name: {{component_name|default:''}}\n- module_path: {{module_path|default:''}}\n- component_type: {{component_type|default:''}}\n- key_dependencies: {{key_dependencies|default:''}}\n- related_docs: {{related_docs|default:''}}\n- language: {{language|default:'python'}}\n- framework: {{framework|default:''}}\n\n# Extended Generation Requirements\nBased on your analysis of the specification, determine if the following additional generation requirements apply. Return true if needed, false otherwise:\n\n- needs_tests: Whether the component needs test generation\n- needs_dependency_setup: Whether the component needs dependency configuration\n- needs_library_integration: Whether the component needs library adapter code\n- needs_component_composition: Whether the component is composed of multiple subcomponents\n\n# For Library Integration\nIf library integration is needed, also extract:\n- target_library: The specific library to integrate with\n\n# Framework Detection\nAnalyze the specification to identify the framework being used. If it mentions React, set framework to 'react'. If it mentions Angular, set framework to 'angular'. For Vue, set to 'vue', etc.\n\n# For Testing\nIf testing is needed, also extract:\n- testing_framework: The preferred testing framework\n\nIf component_name is not provided and not in the spec, derive a clean title-case name from component_id.\n\nFor related_docs, identify any documentation files this component might need based on its dependencies, like 'context_docs', 'utils_docs', etc.\n\nProvide a JSON object with these fields, using reasonable defaults when information is not clear.",
      "model": "{{model|default:'azure:o3-mini'}}",
      "artifact": "extracted_info"
    },
    {
      "type": "execute_recipe",
      "recipe_path": "recipes/component_blueprint_generator/create.json",
      "context_overrides": {
        "candidate_spec": "{{candidate_spec}}",
        "component_id": "{{component_id|default:extracted_info.component_id}}",
        "component_name": "{{component_name|default:extracted_info.component_name}}",
        "module_path": "{{module_path|default:extracted_info.module_path}}",
        "component_type": "{{component_type|default:extracted_info.component_type}}",
        "key_dependencies": "{{key_dependencies|default:extracted_info.key_dependencies}}",
        "related_docs": "{{related_docs|default:extracted_info.related_docs}}",
        "target_project": "{{target_project|default:''}}",
        "component_path": "{{component_path|default:''}}",
        "output_root": "{{output_root|default:'output'}}",
        "project_recipe_path": "{{project_recipe_path}}",
        "language": "{{language|default:extracted_info.language}}",
        "framework": "{{framework|default:extracted_info.framework}}",
        "generate_tests": "{{generate_tests|default:extracted_info.needs_tests}}",
        "setup_dependencies": "{{setup_dependencies|default:extracted_info.needs_dependency_setup}}",
        "integrate_library": "{{integrate_library|default:extracted_info.needs_library_integration}}",
        "compose_components": "{{compose_components|default:extracted_info.needs_component_composition}}",
        "target_library": "{{target_library|default:extracted_info.target_library}}",
        "testing_framework": "{{testing_framework|default:extracted_info.testing_framework}}",
        "extension": "{{extension|default:language | replace: 'typescript', 'tsx' | replace: 'javascript', 'jsx' | default: 'py'}}",
        "testing_best_practices": "{{testing_best_practices}}",
        "dependency_best_practices": "{{dependency_best_practices}}",
        "library_integration_best_practices": "{{library_integration_best_practices}}",
        "composition_best_practices": "{{composition_best_practices}}"
      }
    }
  ]
}
